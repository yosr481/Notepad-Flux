/**
 * CodeMirror Extensions Styles
 * Styles for custom CodeMirror widgets and decorations
 */

/* ============================================
   IMAGE PREVIEW STYLES
   ============================================ */

/* Image container - active state (block display) */
.cm-image-container.cm-active {
    display: block;
}

.cm-image-container.cm-active .cm-image {
    display: block;
    border-radius: var(--radius-l);
    box-shadow: var(--shadow-image);
    transition: all var(--transition-normal);
}

.cm-image-container.cm-active .cm-image:hover {
    box-shadow: var(--shadow-m);
}

.cm-image-container.cm-active.cm-selected .cm-image {
    box-shadow: 0 0 0 3px var(--color-focus-blue);
}

/* Image container - inactive state (inline display) */
.cm-image-container.cm-inactive {
    display: inline;
}

.cm-image-container.cm-inactive .cm-image {
    display: inline-block;
    vertical-align: middle;
    border-radius: var(--radius-m);
    box-shadow: var(--shadow-s);
}

/* Broken image - active state */
.cm-image-broken.cm-active {
    display: flex;
    padding: var(--space-8);
    border-radius: var(--radius-m);
    color: var(--text-error);
}

/* Broken image - inactive state */
.cm-image-broken.cm-inactive {
    display: inline-flex;
    vertical-align: middle;
    color: var(--text-error);
}

/* ============================================
   LINK PREVIEW STYLES
   ============================================ */

.cm-link {
    color: var(--text-accent);
    text-decoration: none;
    transition: color var(--transition-fast);
    font-weight: inherit;
    /* Ensure bold/italic are inherited */
}

.cm-link:hover {
    color: var(--text-accent-hover);
    text-decoration: underline;
}

.cm-link-icon {
    margin-left: 4px;
    opacity: 0.7;
    display: inline-flex;
    vertical-align: middle;
}

/* ============================================
   CHECKBOX STYLES (Flux Design)
   ============================================ */

.cm-checkbox {
    appearance: none;
    -webkit-appearance: none;
    width: 16px;
    height: 16px;
    border: 1.5px solid var(--color-slate-400);
    border-radius: 4px;
    background-color: transparent;
    cursor: pointer;
    position: relative;
    top: 3px;
    margin-right: 8px;
    transition: all var(--transition-fast);
}

.cm-checkbox:checked {
    background-color: var(--color-flux-violet);
    border-color: var(--color-flux-violet);
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
    background-size: 12px;
    background-position: center;
    background-repeat: no-repeat;
    animation: checkbox-pop 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.cm-checkbox:hover {
    border-color: var(--color-flux-violet);
}

@keyframes checkbox-pop {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.1);
    }

    100% {
        transform: scale(1);
    }
}

/* Strikethrough for checked tasks */
.cm-task-checked {
    text-decoration: line-through;
    opacity: 0.6;
    color: var(--text-muted);
}

/* ============================================
   BLOCKQUOTE STYLES
   ============================================ */

/* Vertical bar that replaces the > character */
.cm-quote-bar {
    display: inline-block;
    width: 2px;
    height: 1.2em;
    background-color: var(--color-flux-violet);
    margin-right: 8px;
    vertical-align: text-bottom;
    border-radius: 1px;
}

/* Text styling for blockquote lines */
.cm-blockquote-text {
    color: var(--text-muted);
}

/* Border for blockquote lines */
.cm-line.cm-blockquote-line {
    border-left: 3px solid var(--text-accent);
    padding-left: 1em;
    padding-right: 1em;
    background-color: var(--background-secondary);
}

/* ============================================
   LINK HANDLER STYLES
   ============================================ */

.cm-tooltip {
    border: none !important;
    outline: none !important;
    background: transparent !important;
}

.cm-tooltip-cursor {
    padding: var(--space-4) var(--space-8);
    background-color: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: var(--radius-s);
    font-size: var(--font-size-xs);
    font-family: var(--font-text);
    font-weight: var(--font-weight-regular);
    color: var(--text-normal);
    z-index: var(--z-tooltip);
    box-shadow: var(--shadow-m);
    transition: opacity var(--transition-fast);
}

/* ============================================
   WIDGET STYLES
   ============================================ */

.cm-hr {
    margin: var(--space-24) 0;
    height: 1px;
    background-color: var(--background-modifier-border);
    border: none;
}

/* ============================================
   TABLE STYLES
   ============================================ */

.cm-table-empty {
    color: var(--text-muted);
    padding: 1em;
    font-style: italic;
}

.cm-table-widget table {
    border-collapse: collapse;
}

.cm-table-widget th,
.cm-table-widget td {
    border: 1px solid var(--background-modifier-border);
    padding: 8px;
    opacity: 0.9;
}

.cm-table-widget th {
    background-color: var(--background-secondary-alt);
    font-weight: 600;
}